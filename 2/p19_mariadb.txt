1. mysql 안에서 userghd 라는 유저를 만들어서 dbghd 대상으로 모든 권한 부여. 이후 userghd 접속해서 권한 확인

2. 도메인 설정
생성자 계정     : main
자동생성디렉터리: public_html (DocumentRoot 로 사용)
도메인          : www.lingus.com
화면내용        : MAIN


문제 해결:
0. 패키지 다운로드
1. 유저 생성 및 권한 부여
2. 권한 확인
4. 도메인 설정
5. main 유저 생성 및 자동생성디렉터리 설정


0. 패키지 다운로드
    yum -y install bind-* httpd-* mariadb-*
    systemctl restart mariadb
    systemctl restart named
    systemctl restart httpd


1. 유저 생성 및 권한 부여
    mysql -u root -p mysql

    update user set password=password('ghdwpaks') where user='root';
    로 user 테이블 안에 있던 root 이름의 모든 사용자의 비밀번호를 ghdwpaks 으로 바꿔주고
    
    delete from user where user=' ';
    delete from db where user=' ';
    위험한 익명 사용자 없애주고

    insert into user(host,user,password) values ('localhost','userghd',password('ghdwpaks'));
    로 유저 추가해주고

    insert into db values ('localhost','dbghd','userghd','y','y','y','y','y','y','y','y','y','y','y','y','y','y','y','y','y','y','y');
    로 유저 권한 추가해주고


    확인하기 전에,
    create database dbghd;
    이 모든 권한이 적용될 db 를 생성해주기
    
    exit
    나가기.

    systemctl restart mariadb
    데몬 재실행

2. 권한 확인
    mysql -u userghd -p dbghd
    입력한 후

    ghdwpaks
    입력해서 비밀번호 치고
    접속 확인하기

    show tables;
    권한 확인하고

    exit
    나가기

4. 도메인 설정
    vi /etc/named.conf
    열어서

    listen-on port 53 { any; };
    allow-query     { any; };
    변경해주고 닫기.


    vi /etc/named.rfc1912.zones
    열어서, 파일 말단에
    
    zone "lingus.com" IN {
            type master;
            file "lingus.zone";
            allow-update {any;};
            allow-transfer {any;};
    };

    zone "127.168.192.in-addr.arpa" IN {
            type master;
            file "lingus.rev";
            allow-update {any;};
            allow-transfer {any;};
    };
    입력해주고 닫기.

    cd /var/named
    디렉터리 들어가고

    cp named.localhost lingus.zone
    복사해서

    [root@server named]# cat lingus.zone
    $TTL 1D
    @       IN SOA  lingus.com.             root(
                                            0       ; serial
                                            1D      ; refresh
                                            1H      ; retry
                                            1W      ; expire
                                            3H )    ; minimum
            IN      NS      lingus.com.
            IN      A       192.168.127.128

    www     IN      A       192.168.127.128
    [root@server named]#

    이렇게 내용넣고

    cp lingus.zone lingus.rev
    복사해서
    
    
    [root@server named]# cat lingus.rev
    $TTL 1D
    @       IN SOA  lingus.com.             root(
                                            0       ; serial
                                            1D      ; refresh
                                            1H      ; retry
                                            1W      ; expire
                                            3H )    ; minimum
            IN      NS      lingus.com.
            IN      A       192.168.127.128

    128     IN      PTR     www.lingus.com.
    [root@server named]#
    이렇게 내용넣고 나오기

    chmod 660 lin*
    chown .named lin*
    데몬이 읽게 파일 권한 설정 해주고

    systemctl restart named
    (* 문제 생길시 여기 참조 https://hbesthee.tistory.com/1681)
    데몬 재실행 해주고

    vi /etc/resolv.conf
    파일 열어서
    
    [root@server named]# cat /etc/resolv.conf
    # Generated by NetworkManager
    nameserver 192.168.127.128
    nameserver 192.168.127.2
    [root@server named]#

    위와같이 '나'에게 제일 먼저 FQDN 을 물어보도록 설정하기

    ***위의 과정을 몇차례의 추가 문제 해결이 있었던 과정입니다.***


5. main 유저 생성 및 자동생성디렉터리 설정
    mkdir /etc/skel/public_html
    public_html 이라는 디렉터리를 모든 일반유저의 뼈대 설정 안에 넣고

    useradd main
    main 추가하고

    chmod 701 ~main
    apache 가 쓸 수 있게 main 유저 홈 디렉터리 권한 설정

    echo "MAIN's home" >> ~main/public_html/index.html
    main 유저 홈 디렉터리 안에 public_html 디렉터리 안에 index 파일 만들기

    vi /etc/httpd/conf/httpd.conf 
    열어서
    DocumentRoot "/www/html"
    을
    DocumentRoot "/home/main/public_html"
    바꾼다.

    그 아래에
    <Directory "/var/www">
    을
    <Directory "/home/main">
    바꾸고

    
    # Further relax access to the default document root:
    <Directory "/www/html">
    을
    # Further relax access to the default document root:
    <Directory "/home/main/public_html">
    바꾸고
    
    나온다.

    systemctl restart httpd
    데몬 재시작해준다.

+ 확인
리눅스 안에 있는 아무 브라우저 하나 열어서
www.lingus.com
url 쳐서 들어갔을때
MAIN's home
이라는 구문이 나오면 성공이다.

lingus 는 ling us 가 아니라 lin gus 입니다
리눅스 잘못치면 린구스 돼서 함 써봤습니다









